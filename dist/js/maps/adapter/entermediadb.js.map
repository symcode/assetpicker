{"version":3,"sources":["adapter/node_modules/browser-pack/_prelude.js","adapter/src/js/adapter/entermediadb/index.js","adapter/entermediadb.js","adapter/src/js/adapter/entermediadb/template.html"],"names":["f","exports","module","define","amd","g","window","global","self","this","AssetPickerAdapterEntermediadb","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","translations","description","en","de","template","http","options","base","config","url","replace","validate","response","data","json","status","login","username","password","callback","post","id","isValid","then","results","reload","category","search","items","extensions","watch","appConfig.pick","handler","oldTerms","assembleTerms","newTerms","hash","pop","loadAssets","immediate","dateFormat","methods","terms","pushTerm","field","operator","value","push","join","query","JSON","stringify","result","Array","prototype","apply","total","loading","page","pages","$promise","resolve","hitsperpage","parseInt","totalhits","emshareUrl","forEach","asset","item","createItem","type","isfolder","name","assettitle","primaryfile","title","extension","fileformat","created","parseDate","assetcreationdate","assetaddeddate","modified","assetmodificationdate","thumbnail","encodeURI","sourcepath","links","open","download","bind","events","select-item","$parent","$dispatch","load-more-items","sword","category-load-items","tree","map","category-select-item","selected","./template.html","2"],"mappings":"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","file":"../../adapter/entermediadb.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports = {\r\n    translations: {\r\n        description: {\r\n            en: 'EnterMediaDB on {{config.url}}',\r\n            de: 'EnterMediaDB auf {{config.url}}'\r\n        }\r\n    },\r\n    template: require('./template.html'),\r\n    http: function() {\r\n        var options = {\r\n            base: this.config.url.replace(/\\/+$/, '') + '/mediadb/services',\r\n            validate: function (response) {\r\n                response.data = response.json();\r\n                if (response.data.response.status !== 'ok') {\r\n                    this.login(function(username, password, callback) {\r\n                        this.http.post('authentication/login', {id: username, password: password}, {validate: function (response) {\r\n                            response.data = response.json();\r\n                            response.isValid(response.data.response.status === 'ok');\r\n                        }}).then(\r\n                            function (response) {\r\n                                callback(response.data.results.status !== 'invalidlogin');\r\n                            }\r\n                        );\r\n                    }).then(response.reload);\r\n                } else {\r\n                    response.isValid();\r\n                }\r\n            }\r\n        };\r\n        return options;\r\n    },\r\n    data: function () {\r\n        return {\r\n            category: null,\r\n            search: null,\r\n            items: null,\r\n            results: {},\r\n            extensions: null\r\n        }\r\n    },\r\n    watch: {\r\n        'appConfig.pick': {\r\n            handler: function (config) {\r\n                // Reload latest items when extensions have changed\r\n                var oldTerms = this.assembleTerms();\r\n                this.extensions = config.extensions;\r\n                var newTerms = this.assembleTerms();\r\n                if (oldTerms.hash !== newTerms.hash && this.results[oldTerms.hash]) {\r\n                    var items = this.results[oldTerms.hash].items;\r\n                    while (items.length > 0) {\r\n                        items.pop();\r\n                    }\r\n                    this.loadAssets(items);\r\n                }\r\n            },\r\n            immediate: true\r\n        }\r\n    },\r\n    dateFormat: 'YYYY-MM-DDTHH:mm:ss',\r\n    methods: {\r\n        assembleTerms: function () {\r\n            var terms = [],\r\n                pushTerm = function (field, operator, value) {\r\n                    terms.push({field: field, operator: operator, value: value});\r\n                };\r\n            if (this.category) {\r\n                pushTerm('category', 'exact', this.category.id);\r\n            }\r\n            if (this.search) {\r\n                pushTerm('description', 'freeform', this.search);\r\n            }\r\n            if (this.extensions && this.extensions.length) {\r\n                pushTerm('fileformat', 'matches', this.extensions.join('|'))\r\n            }\r\n            if (!terms.length) {\r\n                pushTerm('id', 'matches', '*');\r\n            }\r\n            return terms;\r\n        },\r\n        loadAssets: function (items) {\r\n            var terms = this.assembleTerms();\r\n            var query = JSON.stringify(terms);\r\n            var result = this.results[query];\r\n            if (!result) {\r\n                result = {page: 0, pages: 0, items: items || []};\r\n                result.items.total = result.items.total || result.items.length;\r\n                this.results[query] = result;\r\n            } else {\r\n                if (items && result.items !== items) {\r\n                    Array.prototype.push.apply(items, result.items);\r\n                    items.total = result.items.total;\r\n                    items.loading = result.items.loading;\r\n                    items.query = query;\r\n                    result.items = items;\r\n                }\r\n                if (result.page === result.pages) {\r\n                    return this.$promise(function (resolve) {\r\n                        resolve(result);\r\n                    });\r\n                }\r\n            }\r\n\r\n            result.items.loading = true;\r\n            result.items.query = query;\r\n\r\n            return this.http.post(\r\n                'module/asset/search',\r\n                {\r\n                    page: '' + (result.page + 1),\r\n                    hitsperpage: '20',\r\n                    query: {\r\n                        terms: terms\r\n                    }\r\n                }\r\n            ).then((function(response) {\r\n                if (result.items.query === query) {\r\n                    result.page = parseInt(response.data.response.page);\r\n                    result.pages = parseInt(response.data.response.pages);\r\n                    result.items.total = parseInt(response.data.response.totalhits);\r\n                    result.items.loading = false;\r\n                    var emshareUrl = this.config.url.replace(/\\/+$/, '') + '/emshare';\r\n                    response.data.results.forEach((function (asset) {\r\n                        var item = this.createItem({\r\n                            id: asset.id,\r\n                            query: query,\r\n                            type: asset.isfolder ? 'file' : 'dir',\r\n                            name: asset.assettitle || asset.name || asset.primaryfile,\r\n                            title: asset.assettitle,\r\n                            extension: asset.fileformat.id,\r\n                            created: this.parseDate(asset.assetcreationdate || asset.assetaddeddate),\r\n                            modified: this.parseDate(asset.assetmodificationdate),\r\n                            thumbnail: this.url(\r\n                                '/emshare/views/modules/asset/downloads/preview/thumb/' +\r\n                                encodeURI(asset.sourcepath) + '/thumb.jpg',\r\n                                this.config.url\r\n                            ),\r\n                            links: {\r\n                                open: emshareUrl + '/views/modules/asset/editor/viewer/index.html?assetid=' + asset.id,\r\n                                download: emshareUrl + '/views/activity/downloadassets.html?assetid=' + asset.id\r\n                            },\r\n                            data: asset\r\n                        });\r\n                        result.items.push(item);\r\n                    }).bind(this));\r\n                }\r\n                return result;\r\n            }).bind(this));\r\n        }\r\n    },\r\n    events: {\r\n        'select-item': function (item) {\r\n            if (item === 'entrypoint') {\r\n                this.category = null;\r\n                this.search = null;\r\n                this.loadAssets().then((function(response) {\r\n                    this.items = response.items;\r\n                    this.$parent.$dispatch('select-item', this);\r\n                }).bind(this));\r\n            } else {\r\n                return true;\r\n            }\r\n        },\r\n        'load-more-items': function (results) {\r\n            this.loadAssets(results);\r\n        },\r\n        'search': function (sword, results) {\r\n            this.search = sword;\r\n            this.loadAssets(results);\r\n            return true;\r\n        },\r\n        'category-load-items': function (tree) {\r\n            this.http.post(\r\n                'lists/search/category',\r\n                {\r\n                    hitsperpage: '100',\r\n                    query: {\r\n                        terms: [\r\n                            {\r\n                                field: 'parentid',\r\n                                operator: 'exact',\r\n                                value: tree.item ? tree.item.id : 'index'\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            ).then(function (response) {\r\n                tree.items = response.data.results.map((function(category) {\r\n                    return this.createItem({\r\n                        id: category.id,\r\n                        name: category.name,\r\n                        type: 'category',\r\n                        data: category\r\n                    });\r\n                }).bind(this));\r\n            });\r\n        },\r\n        'category-select-item': function (tree) {\r\n            this.category = tree.item;\r\n            this.search = null;\r\n            this.loadAssets(tree.items).then(function (response) {\r\n                if (tree.selected) {\r\n                    this.$dispatch('select-item', tree);\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n};\r\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.AssetPickerAdapterEntermediadb = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nmodule.exports = {\r\n    translations: {\r\n        description: {\r\n            en: 'EnterMediaDB on {{config.url}}',\r\n            de: 'EnterMediaDB auf {{config.url}}'\r\n        }\r\n    },\r\n    template: require('./template.html'),\r\n    http: function() {\r\n        var options = {\r\n            base: this.config.url.replace(/\\/+$/, '') + '/mediadb/services',\r\n            validate: function (response) {\r\n                response.data = response.json();\r\n                if (response.data.response.status !== 'ok') {\r\n                    this.login(function(username, password, callback) {\r\n                        this.http.post('authentication/login', {id: username, password: password}, {validate: function (response) {\r\n                            response.data = response.json();\r\n                            response.isValid(response.data.response.status === 'ok');\r\n                        }}).then(\r\n                            function (response) {\r\n                                callback(response.data.results.status !== 'invalidlogin');\r\n                            }\r\n                        );\r\n                    }).then(response.reload);\r\n                } else {\r\n                    response.isValid();\r\n                }\r\n            }\r\n        };\r\n        return options;\r\n    },\r\n    data: function () {\r\n        return {\r\n            category: null,\r\n            search: null,\r\n            items: null,\r\n            results: {},\r\n            extensions: null\r\n        }\r\n    },\r\n    watch: {\r\n        'appConfig.pick': {\r\n            handler: function (config) {\r\n                // Reload latest items when extensions have changed\r\n                var oldTerms = this.assembleTerms();\r\n                this.extensions = config.extensions;\r\n                var newTerms = this.assembleTerms();\r\n                if (oldTerms.hash !== newTerms.hash && this.results[oldTerms.hash]) {\r\n                    var items = this.results[oldTerms.hash].items;\r\n                    while (items.length > 0) {\r\n                        items.pop();\r\n                    }\r\n                    this.loadAssets(items);\r\n                }\r\n            },\r\n            immediate: true\r\n        }\r\n    },\r\n    dateFormat: 'YYYY-MM-DDTHH:mm:ss',\r\n    methods: {\r\n        assembleTerms: function () {\r\n            var terms = [],\r\n                pushTerm = function (field, operator, value) {\r\n                    terms.push({field: field, operator: operator, value: value});\r\n                };\r\n            if (this.category) {\r\n                pushTerm('category', 'exact', this.category.id);\r\n            }\r\n            if (this.search) {\r\n                pushTerm('description', 'freeform', this.search);\r\n            }\r\n            if (this.extensions && this.extensions.length) {\r\n                pushTerm('fileformat', 'matches', this.extensions.join('|'))\r\n            }\r\n            if (!terms.length) {\r\n                pushTerm('id', 'matches', '*');\r\n            }\r\n            return terms;\r\n        },\r\n        loadAssets: function (items) {\r\n            var terms = this.assembleTerms();\r\n            var query = JSON.stringify(terms);\r\n            var result = this.results[query];\r\n            if (!result) {\r\n                result = {page: 0, pages: 0, items: items || []};\r\n                result.items.total = result.items.total || result.items.length;\r\n                this.results[query] = result;\r\n            } else {\r\n                if (items && result.items !== items) {\r\n                    Array.prototype.push.apply(items, result.items);\r\n                    items.total = result.items.total;\r\n                    items.loading = result.items.loading;\r\n                    items.query = query;\r\n                    result.items = items;\r\n                }\r\n                if (result.page === result.pages) {\r\n                    return this.$promise(function (resolve) {\r\n                        resolve(result);\r\n                    });\r\n                }\r\n            }\r\n\r\n            result.items.loading = true;\r\n            result.items.query = query;\r\n\r\n            return this.http.post(\r\n                'module/asset/search',\r\n                {\r\n                    page: '' + (result.page + 1),\r\n                    hitsperpage: '20',\r\n                    query: {\r\n                        terms: terms\r\n                    }\r\n                }\r\n            ).then((function(response) {\r\n                if (result.items.query === query) {\r\n                    result.page = parseInt(response.data.response.page);\r\n                    result.pages = parseInt(response.data.response.pages);\r\n                    result.items.total = parseInt(response.data.response.totalhits);\r\n                    result.items.loading = false;\r\n                    var emshareUrl = this.config.url.replace(/\\/+$/, '') + '/emshare';\r\n                    response.data.results.forEach((function (asset) {\r\n                        var item = this.createItem({\r\n                            id: asset.id,\r\n                            query: query,\r\n                            type: asset.isfolder ? 'file' : 'dir',\r\n                            name: asset.assettitle || asset.name || asset.primaryfile,\r\n                            title: asset.assettitle,\r\n                            extension: asset.fileformat.id,\r\n                            created: this.parseDate(asset.assetcreationdate || asset.assetaddeddate),\r\n                            modified: this.parseDate(asset.assetmodificationdate),\r\n                            thumbnail: this.url(\r\n                                '/emshare/views/modules/asset/downloads/preview/thumb/' +\r\n                                encodeURI(asset.sourcepath) + '/thumb.jpg',\r\n                                this.config.url\r\n                            ),\r\n                            links: {\r\n                                open: emshareUrl + '/views/modules/asset/editor/viewer/index.html?assetid=' + asset.id,\r\n                                download: emshareUrl + '/views/activity/downloadassets.html?assetid=' + asset.id\r\n                            },\r\n                            data: asset\r\n                        });\r\n                        result.items.push(item);\r\n                    }).bind(this));\r\n                }\r\n                return result;\r\n            }).bind(this));\r\n        }\r\n    },\r\n    events: {\r\n        'select-item': function (item) {\r\n            if (item === 'entrypoint') {\r\n                this.category = null;\r\n                this.search = null;\r\n                this.loadAssets().then((function(response) {\r\n                    this.items = response.items;\r\n                    this.$parent.$dispatch('select-item', this);\r\n                }).bind(this));\r\n            } else {\r\n                return true;\r\n            }\r\n        },\r\n        'load-more-items': function (results) {\r\n            this.loadAssets(results);\r\n        },\r\n        'search': function (sword, results) {\r\n            this.search = sword;\r\n            this.loadAssets(results);\r\n            return true;\r\n        },\r\n        'category-load-items': function (tree) {\r\n            this.http.post(\r\n                'lists/search/category',\r\n                {\r\n                    hitsperpage: '100',\r\n                    query: {\r\n                        terms: [\r\n                            {\r\n                                field: 'parentid',\r\n                                operator: 'exact',\r\n                                value: tree.item ? tree.item.id : 'index'\r\n                            }\r\n                        ]\r\n                    }\r\n                }\r\n            ).then(function (response) {\r\n                tree.items = response.data.results.map((function(category) {\r\n                    return this.createItem({\r\n                        id: category.id,\r\n                        name: category.name,\r\n                        type: 'category',\r\n                        data: category\r\n                    });\r\n                }).bind(this));\r\n            });\r\n        },\r\n        'category-select-item': function (tree) {\r\n            this.category = tree.item;\r\n            this.search = null;\r\n            this.loadAssets(tree.items).then(function (response) {\r\n                if (tree.selected) {\r\n                    this.$dispatch('select-item', tree);\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n};\r\n\n},{\"./template.html\":2}],2:[function(require,module,exports){\nmodule.exports = '<div>\\n    <tree :fetch=\"fetch\" name=\"category\" :types=\"[\\'category\\']\"></tree>\\n</div>';\n},{}]},{},[1])(1)\n});\n\n","module.exports = '<div>\\n    <tree :fetch=\"fetch\" name=\"category\" :types=\"[\\'category\\']\"></tree>\\n</div>';"]}
{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/extend/index.js","picker.js","node_modules/insert-css/index.js","src/js/picker/components/modal/index.css","src/js/picker/components/modal/index.html","src/js/picker/components/modal/index.js","src/js/picker/components/ui/index.js","src/js/picker/index.js","src/js/picker/util.js","src/js/shared/util/createClass.js","src/js/shared/util/messaging.js","src/js/shared/util/uid.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","AssetPicker","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","hasOwn","Object","prototype","hasOwnProperty","toStr","toString","isArray","arr","Array","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","constructor","key","extend","options","name","src","copy","copyIsArray","clone","target","arguments","deep","2","insertCss","css","position","prepend","container","undefined","document","querySelector","containerId","containers","indexOf","push","styleElements","styleElement","createStyleElement","insertBefore","childNodes","appendChild","charCodeAt","substr","styleSheet","cssText","textContent","createElement","setAttribute","3","4","5","util","transitionEvent","el","transitions","transition","OTransition","MozTransition","WebkitTransition","style","hasTransitions","element","getComputedStyle","transitionDuration","hasTransition","filter","match","Messaging","construct","template","openClassName","modal","frame","matches","messaging","location","origin","render","div","innerHTML","children","addEventListener","event","close","bind","body","_modalClass","className","open","that","setTimeout","contentWindow","addClass","maximize","minimize","removeClass","_closed","closeTransitionHandler","removeEventListener","../../../shared/util/createClass","../../../shared/util/messaging","../../util","./index.css","./index.html","insert-css","6","cssLoaded","picker","loadCss","getDistUrl","config","unique","readonly","ui","hasAttribute","getAttribute","add","propagate","value","picked","JSON","parse","console","error","on","pickedArr","contains","j","storage","id","pick","_getPickConfig","limit","split","join","parentNode","removeChild","renderItems","item","preview","mediaType","fileTypeClass","iconBig","backgroundImage","thumbnail","createDeleteButton","title","icon","createTextNode","button","7","Modal","UI","uid","distUrl","scripts","getElementsByTagName","slice","setConfig","selector","enabled","hostname","pickConfig","uis","_memoryEvents","ready","_callbacks","inputs","querySelectorAll","register","getOrigin","callback","apply","_trigger","args","forEach","preventDefault","getSplitAttr","attr","parseInt","types","extensions","getUi","HTMLElement","nodeType","nodeName","registerServer","getConfig","tagName","toLowerCase","stringify","../shared/util/createClass","../shared/util/uid","./components/modal","./components/ui","8","classNames","newClassNames","file","link","href","type","rel","media","9","protoProps","result","keys","10","windowObject","eventMethod","eventer","messageEvent","originalEvent","source","handle","data","servers","_handlers","object","_createHandler","handler","callbacks","then","_result","method","postMessage","message","methodPath","pop","shift","resolve","res","./createClass","./uid","11","Math","random"],"mappings":"CAAA,SAAAA,GAAA,GAAA,gBAAAC,UAAA,mBAAAC,QAAAA,OAAAD,QAAAD,QAAA,IAAA,kBAAAG,SAAAA,OAAAC,IAAAD,UAAAH,OAAA,CAAA,GAAAK,EAAAA,GAAA,mBAAAC,QAAAA,OAAA,mBAAAC,QAAAA,OAAA,mBAAAC,MAAAA,KAAAC,KAAAJ,EAAAK,YAAAV,MAAA,WAAA,MAAA,SAAAW,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAhB,GAAA,GAAAqB,OAAA,uBAAAL,EAAA,IAAA,MAAAhB,GAAAsB,KAAA,mBAAAtB,EAAA,GAAAuB,GAAAV,EAAAG,IAAAf,WAAAW,GAAAI,GAAA,GAAAQ,KAAAD,EAAAtB,QAAA,SAAAU,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAY,EAAAA,EAAAtB,QAAAU,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAf,QAAA,IAAA,GAAAmB,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAW,OAAAT,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAW,GAAA,SAAAP,EAAAjB,EAAAD,GCAA,YAEA,IAAA0B,GAAAC,OAAAC,UAAAC,eACAC,EAAAH,OAAAC,UAAAG,SAEAC,EAAA,SAAAC,GACA,MAAA,kBAAAC,OAAAF,QACAE,MAAAF,QAAAC,GAGA,mBAAAH,EAAAP,KAAAU,IAGAE,EAAA,SAAAC,GACA,IAAAA,GAAA,oBAAAN,EAAAP,KAAAa,GACA,OAAA,CAGA,IAAAC,GAAAX,EAAAH,KAAAa,EAAA,eACAE,EAAAF,EAAAG,aAAAH,EAAAG,YAAAX,WAAAF,EAAAH,KAAAa,EAAAG,YAAAX,UAAA,gBAEA,IAAAQ,EAAAG,cAAAF,IAAAC,EACA,OAAA,CAKA,IAAAE,EACA,KAAAA,IAAAJ,IAEA,MAAA,mBAAAI,IAAAd,EAAAH,KAAAa,EAAAI,GAGAvC,GAAAD,QAAA,QAAAyC,KACA,GAAAC,GAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACAC,EAAAC,UAAA,GACA9B,EAAA,EACAK,EAAAyB,UAAAzB,OACA0B,GAAA,CAaA,KAVA,iBAAAF,KACAE,EAAAF,EACAA,EAAAC,UAAA,OAEA9B,EAAA,IAEA,MAAA6B,GAAA,gBAAAA,IAAA,kBAAAA,MACAA,MAGA7B,EAAAK,IAAAL,EAGA,GAFAuB,EAAAO,UAAA9B,GAEA,MAAAuB,EAEA,IAAAC,IAAAD,GACAE,EAAAI,EAAAL,GACAE,EAAAH,EAAAC,GAGAK,IAAAH,IAEAK,GAAAL,IAAAV,EAAAU,KAAAC,EAAAd,EAAAa,MACAC,GACAA,GAAA,EACAC,EAAAH,GAAAZ,EAAAY,GAAAA,MAEAG,EAAAH,GAAAT,EAAAS,GAAAA,KAIAI,EAAAL,GAAAF,EAAAS,EAAAH,EAAAF,IAGA,mBAAAA,KACAG,EAAAL,GAAAE,GAQA,OAAAG,SCIMG,GAAG,SAASjC,EAAQjB,EAAOD,GCrFjC,QAAAoD,GAAAC,EAAAX,GACAA,EAAAA,KAEA,IAAAY,GAAAZ,EAAAa,WAAA,EAAA,UAAA,SACAC,EAAAC,SAAAf,EAAAc,UAAAd,EAAAc,UAAAE,SAAAC,cAAA,QACAC,EAAAC,EAAAC,QAAAN,EAGAI,UACAA,EAAAC,EAAAE,KAAAP,GAAA,EACAQ,EAAAJ,MAIA,IAAAK,EAwBA,OAtBAR,UAAAO,EAAAJ,IAAAH,SAAAO,EAAAJ,GAAAN,GACAW,EAAAD,EAAAJ,GAAAN,IAEAW,EAAAD,EAAAJ,GAAAN,GAAAY,IAEA,YAAAZ,EACAE,EAAAW,aAAAF,EAAAT,EAAAY,WAAA,IAEAZ,EAAAa,YAAAJ,IAKA,QAAAZ,EAAAiB,WAAA,KAAAjB,EAAAA,EAAAkB,OAAA,EAAAlB,EAAA7B,SAGAyC,EAAAO,WACAP,EAAAO,WAAAC,SAAApB,EAEAY,EAAAS,aAAArB,EAGAY,EAGA,QAAAC,KACA,GAAAD,GAAAP,SAAAiB,cAAA,QAEA,OADAV,GAAAW,aAAA,OAAA,YACAX,EA/CA,GAAAJ,MACAG,IAiDA/D,GAAAD,QAAAoD,EACAnD,EAAAD,QAAAoD,UAAAA,OD2FMyB,GAAG,SAAS3D,EAAQjB,EAAOD,GE9IjCC,EAAAD,QAAA,iwDFgJM8E,GAAG,SAAS5D,EAAQjB,EAAOD,GGhJjCC,EAAAD,QAAA,+RHkJM+E,GAAG,SAAS7D,EAAQjB,EAAOD,GIlJjC,GAAAyC,GAAAvB,EAAA,UACA8D,EAAA9D,EAAA,cACAkC,EAAAlC,EAAA,cACA+D,EAAA,WACA,GAAAC,GAAAxB,SAAAiB,cAAA,OACAQ,GACAC,WAAA,gBACAC,YAAA,iBACAC,cAAA,gBACAC,iBAAA,sBAEA,KAAA,GAAApE,KAAAgE,GACA,GAAAA,EAAAtD,eAAAV,IAAAsC,SAAAyB,EAAAM,MAAArE,GACA,MAAAgE,GAAAhE,MAIAsE,EAAA,SAAAC,GACA,GAAArC,GAAAhD,OAAAsF,iBAAAD,EAAA,MACAE,GAAA,qBAAA,sBAAA,wBAAA,4BACAC,EAAAD,EAAAE,OAAA,SAAA3E,GACA,GAAA,gBAAAkC,GAAAlC,IAAAkC,EAAAlC,GAAA4E,MAAA,SACA,OAAA,GAGA,SAAAF,EAAArE,QAEAwE,EAAA9E,EAAA,iCAEAjB,GAAAD,QAAAkB,EAAA,qCACA+E,UAAA,SAAAvD,GACAlC,KAAAkC,QAAAD,GAEAyD,SAAAhF,EAAA,gBACAmC,IAAAnC,EAAA,eACAiF,cAAA,yBACAvD,IAAA,MAEAF,GAEAlC,KAAA4F,MAAA,KACA5F,KAAA6F,MAAA,IAEA,IAAAC,GAAA9F,KAAAkC,QAAAE,IAAAmD,MAAA,qBACAvF,MAAA+F,UAAA,GAAAP,GAAAM,EAAAA,EAAA,GAAA5C,SAAA8C,SAAAC,SAEAC,OAAA,WACAlG,KAAAkC,QAAAW,KACAD,EAAA5C,KAAAkC,QAAAW,IAEA,IAAAsD,GAAAjD,SAAAiB,cAAA,MACAgC,GAAAC,UAAApG,KAAAkC,QAAAwD,SACA1F,KAAA4F,MAAAO,EAAAE,SAAA,GACArG,KAAA4F,MAAAU,iBAAA,QAAA,SAAAC,GACAA,EAAA/D,SAAAxC,KAAA4F,OACA5F,KAAAwG,SAEAC,KAAAzG,OACAA,KAAA6F,MAAA7F,KAAA4F,MAAAzC,cAAA,UACAD,SAAAwD,KAAA7C,YAAA7D,KAAA4F,OACA5F,KAAA2G,YAAA3G,KAAA4F,MAAAgB,WAEAC,KAAA,WACA,IAAA7G,KAAA4F,MAAA,CACA5F,KAAAkG,QACA,IAAAY,GAAA9G,IAGA,OAFAA,MAAA6F,MAAAzD,IAAApC,KAAAkC,QAAAE,QACAvC,QAAAkH,WAAA,WAAAD,EAAAD,QAAA,GAGA7G,KAAA+F,UAAAlG,OAAAG,KAAA6F,MAAAmB,cACAxC,EAAAyC,SAAAjH,KAAA4F,MAAA5F,KAAAkC,QAAAyD,gBAEAuB,SAAA,WACA1C,EAAAyC,SAAAjH,KAAA4F,MAAA,0BAEAuB,SAAA,WACA3C,EAAA4C,YAAApH,KAAA4F,MAAA,0BAEAyB,QAAA,aAEAb,MAAA,WACA,GAAA/B,GAAAQ,EAAAjF,KAAA4F,OAAA,CACA,GAAA0B,GAAA,WACAtH,KAAA4F,MAAA2B,oBAAA9C,EAAA6C,GACAtH,KAAAqH,WACAZ,KAAAzG,KACAA,MAAA4F,MAAAU,iBAAA7B,EAAA6C,OAEAtH,MAAAqH,SAEA7C,GAAA4C,YAAApH,KAAA4F,MAAA5F,KAAAkC,QAAAyD,oBJuJG6B,mCAAmC,EAAEC,iCAAiC,GAAGC,aAAa,EAAEC,cAAc,EAAEC,eAAe,EAAE3F,OAAS,EAAE4F,aAAa,IAAIC,GAAG,SAASpH,EAAQjB,EAAOD,GKlPnL,GAAAuI,IAAA,EACA9F,EAAAvB,EAAA,UACA8D,EAAA9D,EAAA,aAEAjB,GAAAD,QAAAkB,EAAA,qCACA+E,UAAA,SAAAP,EAAA8C,GACAD,GACAvD,EAAAyD,QAAAD,EAAAE,aAAA,sBAGAlI,KAAAmI,OAAAlG,GAEAmG,QAAA,EACAC,UAAA,GAEAL,EAAA9F,QAAAoG,IAEAD,SAAAnD,EAAAqD,aAAA,YAAA,QAAA,KAAAjF,QAAA4B,EAAAsD,aAAA,iBAAAvF,OACAmF,OAAAlD,EAAAqD,aAAA,gBAAA,QAAA,KAAAjF,QAAA4B,EAAAsD,aAAA,qBAAAvF,SAIAjD,KAAAyI,KAAA,EACAzI,KAAA0I,WAAA,EACA1I,KAAAgI,OAAAA,EACAhI,KAAAkF,QAAAA,CACA,IAAAyD,GAAAzD,EAAAqD,aAAA,SAAArD,EAAAsD,aAAA,SAAAvF,MACA,IAAA0F,EACA,IACA3I,KAAA4I,OAAAC,KAAAC,MAAAH,GACA,MAAAzI,GACAF,KAAA4I,UACAG,QAAAC,MAAA,kCAAA9D,OAGAlF,MAAA4I,SAEA5I,MAAA4I,OAAA7G,cAAAL,QACA1B,KAAA4I,QAAA5I,KAAA4I,SAEA5I,KAAAkG,QAEA,IAAAY,GAAA9G,IACAgI,GAAAiB,GAAA,OAAA,SAAAL,GACA,IAAA9B,EAAA4B,WAAA1I,KAAAkF,UAAAA,EAAA,CACA,GAAAgE,GAAAN,EAAA7G,cAAAL,OAAAkH,GAAAA,CACA,IAAA9B,EAAA2B,IAAA,CACA,IAAA,GAAA9H,GAAA,EAAAA,EAAAuI,EAAAlI,OAAAL,IAAA,CACA,GAAAwI,IAAA,CACA,IAAArC,EAAAqB,OAAAC,OACA,IAAA,GAAAgB,GAAA,EAAAA,EAAAtC,EAAA8B,OAAA5H,OAAAoI,IACA,GAAAtC,EAAA8B,OAAAQ,GAAAC,UAAAH,EAAAvI,GAAA0I,SAAAvC,EAAA8B,OAAAQ,GAAAE,KAAAJ,EAAAvI,GAAA2I,GAAA,CACAH,GAAA,CACA,OAIAA,GACArC,EAAA8B,OAAArF,KAAA2F,EAAAvI,IAGAuI,EAAApC,EAAA8B,OAGA,MADA9B,GAAAyC,KAAAL,IACA,EAEApC,EAAA4B,WAAA,EACA5B,EAAA2B,KAAA,KAGAc,KAAA,SAAAX,GACA5I,KAAA4I,OAAAA,EACA5I,KAAA0I,WAAA,EACA1I,KAAAgI,OAAA9C,QAAAlF,KAAAkF,QACAlF,KAAAgI,OAAAuB,KAAA,IAAAvJ,KAAAgI,OAAAwB,eAAAxJ,KAAAkF,SAAAuE,MAAAb,EAAA5H,OAAA4H,EAAA,GAAA3F,OAAA2F,GACA5I,KAAAkG,UAEA/B,cAAA,SAAAhC,EAAAyE,GACA,GAAA1B,GAAAhC,SAAAiB,cAAAhC,EAEA,OADA+C,GAAA0B,UAAA,eAAAA,EAAA8C,MAAA,KAAAC,KAAA,iBACAzE,GAEAgB,OAAA,WAUA,GATAlG,KAAAgD,YACAhD,KAAAgD,UAAAhD,KAAAkF,QAAA0E,WAAAjG,aAAA3D,KAAAmE,cAAA,MAAA,MAAAnE,KAAAkF,SACAlF,KAAAkF,QAAA0E,WAAAC,YAAA7J,KAAAkF,UAEAlF,KAAAgD,UAAAoD,UAAA,GACApG,KAAA8J,YAAA9J,KAAA4I,QACApE,GAAAxE,KAAA4I,OAAA5H,QAAAhB,KAAAmI,OAAAE,SAAA,MAAA,UAAA,SAAArI,KAAAkF,QAAA,sBACAlF,KAAAgD,UAAAa,YAAA7D,KAAAkF,SAEAlF,KAAA4I,OAAA5H,SAAAhB,KAAAmI,OAAAE,SAAA,CACA,GAAAoB,GAAAzJ,KAAAgI,OAAAwB,eAAAxJ,KAAAkF,SAAAuE,OACA,IAAAA,GAAA,IAAAA,GAAAzJ,KAAA4I,OAAA5H,OAAAyI,IACAzJ,KAAAgD,UAAAa,YAAA7D,KAAAmE,cAAA,OAAA,QAAAmC,iBAAA,QAAA,SAAApG,GACAF,KAAAyI,KAAA,EACAzI,KAAAkF,QAAAd,aAAA,aAAAqF,EAAAzJ,KAAA4I,OAAA5H,QACAhB,KAAAgI,OAAAnB,KAAA7G,KAAAkF,SACAlF,KAAAkF,QAAAd,aAAA,aAAAqF,IACAhD,KAAAzG,SAIA8J,YAAA,SAAAlB,GACA,IAAA,GAAAjI,GAAA,EAAAG,EAAA8H,EAAA5H,OAAAL,EAAAG,EAAAH,IAAA,CACA,GAAAoJ,GAAA/J,KAAAgD,UAAAa,YAAA7D,KAAAmE,cAAA,MAAA,SACA6F,EAAAD,EAAAlG,YAAA7D,KAAAmE,cAAA,MAAA,YACA8F,EAAAhI,GAAAE,KAAA,QAAAyG,EAAAjI,GAAAsJ,WACAC,EAAA,SAAAD,EAAA9H,IACA6H,GAAAnG,YAAA7D,KAAAmE,cAAA,MAAA+F,IACAD,EAAAE,UACAH,EAAAnG,YAAA7D,KAAAmE,cAAA,MAAA,QAAAa,MAAAoF,gBAAA,OAAAH,EAAAE,QAAA,KAEAvB,EAAAjI,GAAA0J,YACAL,EAAAnG,YAAA7D,KAAAmE,cAAA,MAAA,MAAA8F,EAAA9H,OAAA6C,MAAAoF,gBAAA,OAAAxB,EAAAjI,GAAA0J,UAAA,KAEArK,KAAAmI,OAAAE,UACA2B,EAAAnG,YAAA7D,KAAAsK,mBAAA1B,EAAAjI,IAEA,IAAA4J,GAAAR,EAAAlG,YAAA7D,KAAAmE,cAAA,MAAA,SACA8F,GAAAO,KACAD,EAAA1G,YAAA7D,KAAAmE,cAAA,MAAA,QAAA/B,IAAA6H,EAAAO,KAEAD,EAAA1G,YAAA7D,KAAAmE,cAAA,OAAA+F,IAEAK,EAAA1G,YAAAX,SAAAuH,eAAA7B,EAAAjI,GAAAwB,SAGAmI,mBAAA,SAAAP,GACA,GAAAW,GAAA1K,KAAAmE,cAAA,OAAA,MAUA,OATAuG,GAAApE,iBAAA,QAAA,WAEA,IAAA,GADAsC,MACAjI,EAAA,EAAAG,EAAAd,KAAA4I,OAAA5H,OAAAL,EAAAG,EAAAH,IACAX,KAAA4I,OAAAjI,KAAAoJ,GACAnB,EAAArF,KAAAvD,KAAA4I,OAAAjI,GAGAX,MAAAuJ,KAAAX,IACAnC,KAAAzG,OACA0K,OLsPGlD,mCAAmC,EAAEE,aAAa,EAAEzF,OAAS,IAAI0I,GAAG,SAASjK,EAAQjB,EAAOD,GMlY/F,GAAAoL,GAAAlK,EAAA,sBACAmK,EAAAnK,EAAA,mBACAoK,EAAApK,EAAA,sBACAuB,EAAAvB,EAAA,UAEAqK,EAAA,WACA,GAAAC,GAAA9H,SAAA+H,qBAAA,SACA,OAAAD,GAAAA,EAAAhK,OAAA,GAAAoB,IAAAsH,MAAA,KAAAwB,MAAA,MAAAvB,KAAA,OAGAlK,GAAAD,QAAAkB,EAAA,+BACA+E,UAAA,SAAA0C,EAAAjG,GACAlC,KAAAmL,UAAAhD,GACAjG,EAAAD,GACA,GAEA8I,QAAAA,EACAK,SAAA,sBACAxF,OACAxD,IAAA,MAEAkG,IACA+C,SAAA,IAGAnJ,OAEAA,EAAA0D,MAAAxD,MACAF,EAAA0D,MAAAxD,IAAAF,EAAA6I,QAAA,gBAEA7I,EAAA0D,MAAAxD,IAAAmD,MAAA,0BAAA,cAAArC,SAAA8C,SAAAsF,YACApJ,EAAA0D,MAAAxD,KAAA,IAAA0I,KAGA9K,KAAAuL,cACAvL,KAAAkC,QAAAA,EACAlC,KAAA4F,MAAA,KACA5F,KAAAkF,QAAA,KACAlF,KAAAwL,OAEAxL,KAAAyL,eACAC,MAAA,MAEA1L,KAAA2L,cAEA3L,KAAAiJ,GAAA,QAAA,WACAjJ,KAAA4F,MAAAA,MAAAgB,WAAA,uBAEA5G,KAAAiJ,GAAA,SAAA,SAAA/B,GACAlH,KAAA4F,MAAAsB,EAAA,WAAA,gBAGAhE,SAAAoD,iBAAA,mBAAA,WAEA,IAAA,GADAsF,GAAA1I,SAAA2I,iBAAA7L,KAAAkC,QAAAkJ,UACAzK,EAAA,EAAAG,EAAA8K,EAAA5K,OAAAL,EAAAG,EAAAH,IACAX,KAAA8L,SAAAF,EAAAjL,KAEA8F,KAAAzG,QAEA+L,UAAA,WACA,MAAA7I,UAAA8C,SAAAC,QAEAiC,WAAA,WACA,MAAAlI,MAAAkC,QAAA6I,SAEA9B,GAAA,SAAA1C,EAAAyF,GAQA,MAPAhM,MAAA2L,WAAAtK,eAAAkF,KACAvG,KAAA2L,WAAApF,OAEAvG,KAAA2L,WAAApF,GAAAhD,KAAAyI,GACAhM,KAAAyL,cAAAlF,IACAyF,EAAAC,MAAAjM,KAAAA,KAAAyL,cAAAlF,IAEAvG,MAEAkM,SAAA,SAAA3F,GACA,GAAA4F,GAAAzK,MAAAN,UAAA8J,MAAAnK,KAAA0B,UAAA,EACAzC,MAAA2L,WAAApF,IACAvG,KAAA2L,WAAApF,GAAA6F,QAAA,SAAAJ,GACA,MAAAA,GAAAC,MAAAjM,KAAAmM,IACA1F,KAAAzG,OAEAA,KAAAyL,cAAApK,eAAAkF,KACAvG,KAAAyL,cAAAlF,GAAA4F,IAGAL,SAAA,SAAA5G,GACAA,EAAAqD,aAAA,sBAGArD,EAAAd,aAAA,mBAAA,IACAc,EAAAqD,aAAA,YAAAvI,KAAAkC,QAAAoG,IAAAtI,KAAAkC,QAAAoG,GAAA+C,UACArL,KAAAwL,IAAAjI,KAAA,GAAAsH,GAAA3F,EAAAlF,OAEAkF,EAAAoB,iBAAA,QAAA,SAAAC,GACAA,EAAA8F,iBACArM,KAAA6G,KAAA3B,IACAuB,KAAAzG,SAEAwJ,eAAA,SAAAtE,GACA,GAAAoH,GAAA,SAAAC,GACA,GAAA5D,GAAAzD,EAAAsD,aAAA+D,EACA,OAAA5D,GAAA3H,OAAA2H,EAAAe,MAAA,QAEA,OAAAzH,MAAAjC,KAAAmI,OAAAoB,MACAE,MAAAvE,EAAAqD,aAAA,cAAAiE,SAAAtH,EAAAsD,aAAA,eAAAvF,OACAwJ,MAAAvH,EAAAqD,aAAA,cAAA+D,EAAA,cAAArJ,OACAyJ,WAAAxH,EAAAqD,aAAA,YAAA+D,EAAA,YAAArJ,UAGA0J,MAAA,SAAAzH,GACA,IAAA,GAAAvE,GAAA,EAAAG,EAAAd,KAAAwL,IAAAxK,OAAAL,EAAAG,EAAAH,IACA,GAAAX,KAAAwL,IAAA7K,GAAAuE,UAAAA,EACA,MAAAlF,MAAAwL,IAAA7K,IAIAkG,KAAA,SAAA3E,GAWA,GATA,gBAAA0K,cAAA1K,YAAA0K,cACA1K,GAAA,gBAAAA,IAAA,OAAAA,GAAA,IAAAA,EAAA2K,UAAA,gBAAA3K,GAAA4K,UAEA9M,KAAAkF,QAAAhD,EACAlC,KAAAuL,WAAAvL,KAAAwJ,eAAAtH,KAEAlC,KAAAkF,QAAAjC,OACAjD,KAAAuL,WAAAtJ,KAAAjC,KAAAmI,OAAAoB,KAAArH,IAEAlC,KAAA4F,MAUA,IAEA5F,KAAA4F,MAAAG,UAAAhF,KAAA,iBAAAwI,KAAAvJ,KAAAuL,aACA,MAAArL,QAZAF,MAAA4F,MAAA,GAAAgF,GAAA5K,KAAAkC,QAAA0D,OACA5F,KAAA4F,MAAAG,UAAAgH,eAAA,SAAA/M,MACAA,KAAAiJ,GACA,QACA,WACAjJ,KAAA4F,MAAAG,UAAAhF,KAAA,iBAAAwI,KAAAvJ,KAAAuL,cASAvL,MAAA4F,MAAAiB,QAEAmG,UAAA,WACA,MAAAhN,MAAAmI,QAEAgD,UAAA,SAAAhD,GACAnI,KAAAmI,OAAAlG,GACA,GAEAsH,MACAE,MAAA,EACAgD,OAAA,QACAC,gBAGAvE,GAEAnI,KAAA4F,OACAoC,OAAApC,MAAAG,UAAAhF,KAAA,gBAAAf,KAAAmI,SAGAoB,KAAA,SAAAX,GACA,GAAA5I,KAAAkF,QAAA,CACA,GAAA+H,GAAAjN,KAAAkF,QAAA+H,QAAAC,eACA,UAAAD,GAAA,WAAAjN,KAAAkF,QAAAsD,aAAA,SAAA,WAAAyE,IACAjN,KAAAkF,QAAAd,aAAA,QAAAwE,EAAAC,KAAAsE,UAAAvE,GAAA,IAGA5I,KAAAkM,SAAA,OAAAtD,GACA5I,KAAA4F,OACA5F,KAAA4F,MAAAY,aNwYG4G,6BAA6B,EAAEC,qBAAqB,GAAGC,qBAAqB,EAAEC,kBAAkB,EAAEtL,OAAS,IAAIuL,GAAG,SAAS9M,EAAQjB,EAAOD,GOrjB7IC,EAAAD,SACAyH,SAAA,SAAA/B,EAAA0B,GACA1B,EAAA0B,UACA1B,EAAA0B,UAAA8C,MAAA,KAAApG,QAAAsD,UACA1B,EAAA0B,WAAA,IAAAA,GAGA1B,EAAA0B,UAAAA,GAGAQ,YAAA,SAAAlC,EAAA0B,GACA,GAAA1B,EAAA0B,UAAA,CAEA,IAAA,GADA6G,GAAAvI,EAAA0B,UAAA8C,MAAA,KAAAgE,KACA/M,EAAA,EAAAG,EAAA2M,EAAAzM,OAAAL,EAAAG,EAAAH,IACA8M,EAAA9M,KAAAiG,GACA8G,EAAAnK,KAAAkK,EAAA9M,GAGAuE,GAAA0B,UAAA8G,EAAA/D,KAAA,OAGA1B,QAAA,SAAA0F,GACA,GAAAC,GAAA1K,SAAAiB,cAAA,OACAyJ,GAAAC,KAAAF,EACAC,EAAAE,KAAA,WACAF,EAAAG,IAAA,aACAH,EAAAI,MAAA,eAEA9K,SAAA+H,qBAAA,QAAA,GAAApH,YAAA+J,UPyjBMK,GAAG,SAASvN,EAAQjB,EAAOD,GQrlBjCC,EAAAD,QAAA,SAAA0O,GACA,GAAAC,GAAA,WACAnO,KAAAyF,WACAzF,KAAAyF,UAAAwG,MAAAjM,KAAAyC,WASA,OALA0L,GAAA/M,UAAA+M,EACAhN,OAAAiN,KAAAF,GAAA9B,QAAA,SAAApK,GACAmM,EAAA/M,UAAAY,GAAAkM,EAAAlM,KAGAmM,QRylBME,IAAI,SAAS3N,EAAQjB,EAAOD,GSrmBlC,GAAAsL,GAAApK,EAAA,QAEAjB,GAAAD,QAAAkB,EAAA,kBACA+E,UAAA,SAAAQ,EAAAqI,GACA,GAAAC,GAAA1O,OAAAyG,iBAAA,mBAAA,cACAkI,EAAA3O,OAAA0O,GACAE,EAAA,eAAAF,EAAA,YAAA,SACAC,GAAAC,EAAA,SAAAvO,GACA,GAAA+F,GAAA/F,EAAA+F,QAAA/F,EAAAwO,cAAAzI,QACA/F,EAAAyO,SAAA3O,KAAAH,QAAAoG,IAAAjG,KAAAiG,QAAA,MAAAjG,KAAAiG,SACAjG,KAAA4O,OAAA1O,EAAA2O,OAEApI,KAAAzG,OAAA,GAEAA,KAAAiG,OAAAA,EACAjG,KAAAH,OAAAyO,EACAtO,KAAA8O,WACA9O,KAAA+O,cAEAhC,eAAA,SAAA5K,EAAA6M,GACAhP,KAAA8O,QAAA3M,GAAA6M,GAEAC,eAAA,WACA,GAAAC,IAAAC,aASA,OARAD,GAAAE,KAAA,SAAApD,GAMA,MALAkD,GAAA7N,eAAA,WACA2K,EAAAkD,EAAAG,SAEAH,EAAAC,UAAA5L,KAAAyI,GAEAkD,GAEAA,GAEAnO,KAAA,SAAAuO,GACA,GAAA7M,WAAAf,MAAAN,UAAA8J,MAAAnK,KAAA0B,UAAA,GACA6G,EAAAwB,IAAAoE,EAAAlP,KAAAiP,gBAGA,OAFAjP,MAAA+O,UAAAzF,GAAA4F,EACAlP,KAAAH,OAAA0P,aAAAjG,GAAAA,EAAAgG,OAAAA,EAAA7M,UAAAA,WAAAzC,KAAAiG,QACAiJ,GAEAN,OAAA,SAAAY,GACA,GAAA,YAAAA,EAAAF,QACA,GAAAtP,KAAA+O,UAAAS,EAAAlG,IAAA,CAEA,IAAA,GADA4F,GAAAlP,KAAA+O,UAAAS,EAAAlG,IACA3I,EAAA,EAAAG,EAAAoO,EAAAC,UAAAnO,OAAAL,EAAAG,EAAAH,IACAuO,EAAAC,UAAAxO,GAAA6O,EAAArB,OAEAe,GAAAG,QAAAG,EAAArB,aACAnO,MAAA+O,UAAAS,EAAAlG,SAEA,CAIA,IAHA,GAAAmG,GAAAD,EAAAF,OAAA5F,MAAA,KACA4F,EAAAG,EAAAC,MACAlN,EAAAxC,KAAA8O,QACAtM,GAAAiN,EAAAzO,QACAwB,EAAAA,EAAAiN,EAAAE,QAEA,KAAAnN,IAAAA,EAAA8M,GACA,KAAA,mBAAAE,EAAAF,OAAA,GAEA,IAAAnB,GAAA3L,EAAA8M,GAAArD,MAAAzJ,EAAAgN,EAAA/M,WACAmN,EAAA,SAAAC,GAEAL,EAAAlG,IACAtJ,KAAAH,OAAA0P,aAAAD,OAAA,UAAAhG,GAAAkG,EAAAlG,GAAA6E,OAAA0B,GAAA7P,KAAAiG,SAEAQ,KAAAzG,KACA,mBAAAmO,GACAA,EAAAyB,GAEAA,EAAAzB,ST4mBG2B,gBAAgB,EAAEC,QAAQ,KAAKC,IAAI,SAAStP,EAAQjB,EAAOD,GUnrB9DC,EAAAD,QAAA,WACA,MAAA,GAAAyQ,KAAAC,SAAA3O,SAAA,IAAAwC,OAAA,EAAA,cVurBW,IAAI","file":"../picker.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.AssetPicker = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n},{}],2:[function(require,module,exports){\nvar containers = []; // will store container HTMLElement references\nvar styleElements = []; // will store {prepend: HTMLElement, append: HTMLElement}\n\nfunction insertCss(css, options) {\n    options = options || {};\n\n    var position = options.prepend === true ? 'prepend' : 'append';\n    var container = options.container !== undefined ? options.container : document.querySelector('head');\n    var containerId = containers.indexOf(container);\n\n    // first time we see this container, create the necessary entries\n    if (containerId === -1) {\n        containerId = containers.push(container) - 1;\n        styleElements[containerId] = {};\n    }\n\n    // try to get the correponding container + position styleElement, create it otherwise\n    var styleElement;\n\n    if (styleElements[containerId] !== undefined && styleElements[containerId][position] !== undefined) {\n        styleElement = styleElements[containerId][position];\n    } else {\n        styleElement = styleElements[containerId][position] = createStyleElement();\n\n        if (position === 'prepend') {\n            container.insertBefore(styleElement, container.childNodes[0]);\n        } else {\n            container.appendChild(styleElement);\n        }\n    }\n\n    // strip potential UTF-8 BOM if css was read from a file\n    if (css.charCodeAt(0) === 0xFEFF) { css = css.substr(1, css.length); }\n\n    // actually add the stylesheet\n    if (styleElement.styleSheet) {\n        styleElement.styleSheet.cssText += css\n    } else {\n        styleElement.textContent += css;\n    }\n\n    return styleElement;\n};\n\nfunction createStyleElement() {\n    var styleElement = document.createElement('style');\n    styleElement.setAttribute('type', 'text/css');\n    return styleElement;\n}\n\nmodule.exports = insertCss;\nmodule.exports.insertCss = insertCss;\n\n},{}],3:[function(require,module,exports){\nmodule.exports = '.assetpicker-modal {\\n    position: fixed;\\n    top: 0;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    background: rgba(0, 0, 0, 0);\\n    z-index: -1;\\n    transition: background 0.2s, z-index 0s 0.2s;\\n}\\n.assetpicker-modal.assetpicker-modal-open {\\n    z-index:3000;\\n    background: rgba(0, 0, 0, 0.8);\\n    transition: background 0.2s\\n}\\n.assetpicker-modal .assetpicker-modal-inner {\\n    position: absolute;\\n    background: #fff;\\n    width: 800px;\\n    height: 500px;\\n    max-width: calc(100% - 30px);\\n    max-height: calc(100% - 30px);\\n    left:50%;\\n    top:50%;\\n    transform: translateY(-50%) translateX(-50%);\\n    opacity: 0;\\n    transition: opacity 0.1s 0.1s;\\n    border-radius: 4px;\\n    overflow: hidden;\\n}\\n.assetpicker-modal.assetpicker-maximized .assetpicker-modal-inner {\\n    width: 100%;\\n    height: 100%;\\n}\\n.assetpicker-modal.assetpicker-modal-open .assetpicker-modal-inner {\\n    opacity: 1;\\n}\\n.assetpicker-modal .assetpicker-modal-inner iframe {\\n    position: absolute;\\n    background: transparent;\\n    top:0;\\n    left:0;\\n    width:100%;\\n    height: 100%;\\n    overflow: hidden;\\n    border: none;\\n}\\n\\n.assetpicker-loader {\\n    border: 5px solid gray;\\n    border-radius: 30px;\\n    height: 30px;\\n    left: 50%;\\n    margin: -15px 0 0 -15px;\\n    opacity: 0;\\n    position: absolute;\\n    top: 50%;\\n    width: 30px;\\n\\n    animation: assetpicker-loader-pulsate 1s ease-out;\\n    animation-iteration-count: infinite;\\n}\\n.assetpicker-ready .assetpicker-loader {\\n    display: none;\\n    animation: none;\\n}\\n\\n@keyframes assetpicker-loader-pulsate {\\n    0% {\\n        transform: scale(.1);\\n        opacity: 0.0;\\n    }\\n    50% {\\n        opacity: 1;\\n    }\\n    100% {\\n        transform: scale(1.2);\\n        opacity: 0;\\n    }\\n}';\n},{}],4:[function(require,module,exports){\nmodule.exports = '<div class=\"assetpicker-modal\">\\n    <div class=\"assetpicker-modal-inner\">\\n        <div class=\"assetpicker-loader\"></div>\\n        <iframe src=\"about:blank\" allowtransparency=\"true\">\\n            Ehm, without iframes i ain\\'t do nothing.\\n        </iframe>\\n    </div>\\n</div>\\n';\n},{}],5:[function(require,module,exports){\nvar extend = require('extend'),\r\n    util = require('../../util'),\r\n    insertCss = require('insert-css'),\r\n    transitionEvent = (function() {\r\n        var el = document.createElement('div');\r\n        var transitions = {\r\n            'transition': 'transitionend',\r\n            'OTransition': 'otransitionend',\r\n            'MozTransition': 'transitionend',\r\n            'WebkitTransition': 'webkitTransitionEnd'\r\n        };\r\n        for (var i in transitions) {\r\n            if (transitions.hasOwnProperty(i) && el.style[i] !== undefined) {\r\n                return transitions[i];\r\n            }\r\n        }\r\n    })(),\r\n    hasTransitions = function(element) {\r\n        var css = window.getComputedStyle(element, null);\r\n        var transitionDuration = ['transitionDuration', 'oTransitionDuration', 'MozTransitionDuration', 'webkitTransitionDuration'];\r\n        var hasTransition = transitionDuration.filter(function (i) {\r\n            if (typeof css[i] === 'string' && css[i].match(/[1-9]/)) {\r\n                return true;\r\n            }\r\n        });\r\n        return hasTransition.length ? true : false;\r\n    },\r\n    Messaging = require('../../../shared/util/messaging');\r\n\r\nmodule.exports = require('../../../shared/util/createClass')({\r\n    construct: function (options) {\r\n        this.options = extend(\r\n            {\r\n                template: require('./index.html'),\r\n                css: require('./index.css'),\r\n                openClassName: 'assetpicker-modal-open',\r\n                src: null\r\n            },\r\n            options\r\n        );\r\n        this.modal = null;\r\n        this.frame = null;\r\n\r\n        var matches = this.options.src.match(/^https?:\\/\\/[^\\/]+/);\r\n        this.messaging = new Messaging(matches ? matches[0] : document.location.origin)\r\n    },\r\n    render: function() {\r\n        if (this.options.css) {\r\n            insertCss(this.options.css);\r\n        }\r\n        var div = document.createElement('div');\r\n        div.innerHTML = this.options.template;\r\n        this.modal = div.children[0];\r\n        this.modal.addEventListener('click', function(event) {\r\n            if (event.target === this.modal) {\r\n                this.close();\r\n            }\r\n        }.bind(this));\r\n        this.frame = this.modal.querySelector('iframe');\r\n        document.body.appendChild(this.modal);\r\n        this._modalClass = this.modal.className;\r\n    },\r\n    open: function() {\r\n        if (!this.modal) {\r\n            this.render();\r\n            var that = this;\r\n            this.frame.src = this.options.src;\r\n            window.setTimeout(function() { that.open(); }, 1);\r\n            return;\r\n        }\r\n        this.messaging.window = this.frame.contentWindow;\r\n        util.addClass(this.modal, this.options.openClassName);\r\n    },\r\n    maximize: function () {\r\n        util.addClass(this.modal, 'assetpicker-maximized');\r\n    },\r\n    minimize: function () {\r\n        util.removeClass(this.modal, 'assetpicker-maximized');\r\n    },\r\n    _closed: function() {\r\n    },\r\n    close: function() {\r\n        if (transitionEvent && hasTransitions(this.modal)) {\r\n            var closeTransitionHandler = function () {\r\n                this.modal.removeEventListener(transitionEvent, closeTransitionHandler);\r\n                this._closed();\r\n            }.bind(this);\r\n            this.modal.addEventListener(transitionEvent, closeTransitionHandler);\r\n        } else {\r\n            this._closed();\r\n        }\r\n        util.removeClass(this.modal, this.options.openClassName);\r\n    }\r\n});\r\n\n},{\"../../../shared/util/createClass\":9,\"../../../shared/util/messaging\":10,\"../../util\":8,\"./index.css\":3,\"./index.html\":4,\"extend\":1,\"insert-css\":2}],6:[function(require,module,exports){\nvar cssLoaded = false;\r\nvar extend = require('extend');\r\nvar util = require('../../util');\r\n\r\nmodule.exports = require('../../../shared/util/createClass')({\r\n    construct: function (element, picker) {\r\n        if (!cssLoaded) {\r\n            util.loadCss(picker.getDistUrl() + '/css/picker-ui.css');\r\n        }\r\n\r\n        this.config = extend(\r\n            {\r\n                unique: true,\r\n                readonly: false\r\n            },\r\n            picker.options.ui,\r\n            {\r\n                readonly: element.hasAttribute('data-ro') ? ['false', '0'].indexOf(element.getAttribute('data-ro')) === -1 : undefined,\r\n                unique: element.hasAttribute('data-unique') ? ['false', '0'].indexOf(element.getAttribute('data-unique')) === -1 : undefined\r\n            }\r\n        );\r\n\r\n        this.add = false;\r\n        this.propagate = false;\r\n        this.picker = picker;\r\n        this.element = element;\r\n        var value = element.hasAttribute('value') ? element.getAttribute('value') : undefined;\r\n        if (value) {\r\n            try {\r\n                this.picked = JSON.parse(value);\r\n            } catch (e) {\r\n                this.picked = [];\r\n                console.error('Error while parsing value of %s', element);\r\n            }\r\n        } else {\r\n            this.picked =[];\r\n        }\r\n        if (this.picked.constructor !== Array) {\r\n            this.picked = [this.picked];\r\n        }\r\n        this.render();\r\n\r\n        var that = this;\r\n        picker.on('pick', function (picked) {\r\n            if (!that.propagate && this.element === element) {\r\n                var pickedArr = picked.constructor !== Array ? [picked] : picked;\r\n                if (that.add) {\r\n                    for (var i = 0; i < pickedArr.length; i++) {\r\n                        var contains = false;\r\n                        if (that.config.unique) {\r\n                            for (var j = 0; j < that.picked.length; j++) {\r\n                                if (that.picked[j].storage === pickedArr[i].storage && that.picked[j].id === pickedArr[i].id) {\r\n                                    contains = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (!contains) {\r\n                            that.picked.push(pickedArr[i]);\r\n                        }\r\n                    }\r\n                    pickedArr = that.picked;\r\n                }\r\n                that.pick(pickedArr);\r\n                return false;\r\n            }\r\n            that.propagate = false;\r\n            that.add = false;\r\n        });\r\n    },\r\n    pick: function (picked) {\r\n        this.picked = picked;\r\n        this.propagate = true;\r\n        this.picker.element = this.element;\r\n        this.picker.pick(this.picker._getPickConfig(this.element).limit === 1 ? (picked.length ? picked[0] : undefined) : picked);\r\n        this.render();\r\n    },\r\n    createElement: function (name, className) {\r\n        var element = document.createElement(name);\r\n        element.className = 'assetpicker-' + className.split(' ').join(' assetpicker-');\r\n        return element;\r\n    },\r\n    render: function () {\r\n        if (!this.container) {\r\n            this.container = this.element.parentNode.insertBefore(this.createElement('div', 'ui'), this.element);\r\n            this.element.parentNode.removeChild(this.element);\r\n        }\r\n        this.container.innerHTML = '';\r\n        this.renderItems(this.picked);\r\n        util[(this.picked.length || this.config.readonly ? 'add' : 'remove') + 'Class'](this.element, 'assetpicker-hidden');\r\n        this.container.appendChild(this.element);\r\n\r\n        if (this.picked.length && !this.config.readonly) {\r\n            var limit = this.picker._getPickConfig(this.element).limit;\r\n            if (limit === 0 || limit !== 1 && this.picked.length < limit) {\r\n                this.container.appendChild(this.createElement('span', 'add')).addEventListener('click', function (e) {\r\n                    this.add = true;\r\n                    this.element.setAttribute('data-limit', limit - this.picked.length);\r\n                    this.picker.open(this.element);\r\n                    this.element.setAttribute('data-limit', limit);\r\n                }.bind(this));\r\n            }\r\n        }\r\n    },\r\n    renderItems: function (picked) {\r\n        for (var i = 0, l = picked.length; i < l; i++) {\r\n            var item = this.container.appendChild(this.createElement('div', 'item'));\r\n            var preview = item.appendChild(this.createElement('div', 'preview'));\r\n            var mediaType = extend({name: 'file'}, picked[i].mediaType);\r\n            var fileTypeClass = 'ft ft-' + mediaType.name;\r\n            preview.appendChild(this.createElement('div', fileTypeClass));\r\n            if (mediaType.iconBig) {\r\n                preview.appendChild(this.createElement('div', 'icn')).style.backgroundImage = 'url(' + mediaType.iconBig + ')';\r\n            }\r\n            if (picked[i].thumbnail) {\r\n                preview.appendChild(this.createElement('div', 'tn ' + mediaType.name)).style.backgroundImage = 'url(' + picked[i].thumbnail + ')';\r\n            }\r\n            if (!this.config.readonly) {\r\n                preview.appendChild(this.createDeleteButton(picked[i]));\r\n            }\r\n            var title = item.appendChild(this.createElement('div', 'title'));\r\n            if (mediaType.icon) {\r\n                title.appendChild(this.createElement('img', 'icn')).src = mediaType.icon;\r\n            } else {\r\n                title.appendChild(this.createElement('span', fileTypeClass));\r\n            }\r\n            title.appendChild(document.createTextNode(picked[i].name));\r\n        }\r\n    },\r\n    createDeleteButton: function (item) {\r\n        var button = this.createElement('span', 'del');\r\n        button.addEventListener('click', function () {\r\n            var picked = [];\r\n            for (var i = 0, l = this.picked.length; i < l; i++) {\r\n                if (this.picked[i] !== item) {\r\n                    picked.push(this.picked[i]);\r\n                }\r\n            }\r\n            this.pick(picked);\r\n        }.bind(this));\r\n        return button;\r\n    }\r\n});\n},{\"../../../shared/util/createClass\":9,\"../../util\":8,\"extend\":1}],7:[function(require,module,exports){\nvar Modal = require('./components/modal');\r\nvar UI = require('./components/ui');\r\nvar uid = require('../shared/util/uid');\r\nvar extend = require('extend');\r\n\r\nvar distUrl = (function() {\r\n    var scripts = document.getElementsByTagName('script');\r\n    return scripts[scripts.length - 1].src.split('/').slice(0, -2).join('/');\r\n})();\r\n\r\nmodule.exports = require('../shared/util/createClass')({\r\n    construct: function(config, options) {\r\n        this.setConfig(config);\r\n        options = extend(\r\n            true,\r\n            {\r\n                distUrl: distUrl,\r\n                selector: '[rel=\"assetpicker\"]',\r\n                modal: {\r\n                    src: null\r\n                },\r\n                ui: {\r\n                    enabled: true\r\n                }\r\n            },\r\n            options || {}\r\n        );\r\n        if (!options.modal.src) {\r\n            options.modal.src = options.distUrl + '/index.html';\r\n        }\r\n        if (options.modal.src.match(/^https?:\\/\\/localhost/) || document.location.hostname === 'localhost') {\r\n            options.modal.src += '?' + uid();\r\n        }\r\n\r\n        this.pickConfig = {};\r\n        this.options = options;\r\n        this.modal = null;\r\n        this.element = null;\r\n        this.uis = [];\r\n\r\n        this._memoryEvents = {\r\n            'ready': null\r\n        };\r\n        this._callbacks = {};\r\n\r\n        this.on('ready', function () {\r\n            this.modal.modal.className += ' assetpicker-ready'\r\n        });\r\n        this.on('resize', function (maximize) {\r\n            this.modal[maximize ? 'maximize' : 'minimize']();\r\n        });\r\n\r\n        document.addEventListener('DOMContentLoaded', function () {\r\n            var inputs = document.querySelectorAll(this.options.selector);\r\n            for (var i = 0, l = inputs.length; i < l; i++) {\r\n                this.register(inputs[i]);\r\n            }\r\n        }.bind(this));\r\n    },\r\n    getOrigin: function () {\r\n        return document.location.origin;\r\n    },\r\n    getDistUrl: function () {\r\n        return this.options.distUrl;\r\n    },\r\n    on: function (event, callback) {\r\n        if (!this._callbacks.hasOwnProperty(event)) {\r\n            this._callbacks[event] = [];\r\n        }\r\n        this._callbacks[event].push(callback);\r\n        if (this._memoryEvents[event]) {\r\n            callback.apply(this, this._memoryEvents[event]);\r\n        }\r\n        return this;\r\n    },\r\n    _trigger: function (event) {\r\n        var args = Array.prototype.slice.call(arguments, 1);\r\n        if (this._callbacks[event]) {\r\n            this._callbacks[event].forEach(function (callback) {\r\n                return callback.apply(this, args);\r\n            }.bind(this));\r\n        }\r\n        if (this._memoryEvents.hasOwnProperty(event)) {\r\n            this._memoryEvents[event] = args;\r\n        }\r\n    },\r\n    register: function (element) {\r\n        if (element.hasAttribute('data-assetpicker')) {\r\n            return;\r\n        }\r\n        element.setAttribute('data-assetpicker', 1);\r\n        if (element.hasAttribute('data-ui') || this.options.ui && this.options.ui.enabled) {\r\n            this.uis.push(new UI(element, this));\r\n        }\r\n        element.addEventListener('click', function (event) {\r\n            event.preventDefault();\r\n            this.open(element);\r\n        }.bind(this));\r\n    },\r\n    _getPickConfig: function (element) {\r\n        var getSplitAttr = function (attr) {\r\n            var value = element.getAttribute(attr);\r\n            return value.length ? value.split(',') : []\r\n        };\r\n        return extend({}, this.config.pick, {\r\n            limit: element.hasAttribute('data-limit') ? parseInt(element.getAttribute('data-limit')) : undefined,\r\n            types: element.hasAttribute('data-types') ? getSplitAttr('data-types') : undefined,\r\n            extensions: element.hasAttribute('data-ext') ? getSplitAttr('data-ext') : undefined\r\n        });\r\n    },\r\n    getUi: function (element) {\r\n        for (var i = 0, l = this.uis.length; i < l; i++) {\r\n            if (this.uis[i].element === element) {\r\n                return this.uis[i];\r\n            }\r\n        }\r\n    },\r\n    open: function (options) {\r\n        if (// http://stackoverflow.com/a/384380, options is a HTMLElement\r\n            typeof HTMLElement === \"object\" && options instanceof HTMLElement //DOM2\r\n            || options && typeof options === \"object\" && options !== null && options.nodeType === 1 && typeof options.nodeName===\"string\") {\r\n\r\n            this.element = options;\r\n            this.pickConfig = this._getPickConfig(options);\r\n        } else {\r\n            this.element = undefined;\r\n            this.pickConfig = extend({}, this.config.pick, options);\r\n        }\r\n        if (!this.modal) {\r\n            this.modal = new Modal(this.options.modal);\r\n            this.modal.messaging.registerServer('picker', this);\r\n            this.on(\r\n                'ready',\r\n                function () {\r\n                    this.modal.messaging.call('app.setConfig', {pick: this.pickConfig})\r\n                }\r\n            );\r\n        } else {\r\n            try {\r\n                // When this fails, it likely means the app is not ready yet and above ready listener will handle this\r\n                this.modal.messaging.call('app.setConfig', {pick: this.pickConfig});\r\n            } catch (e) {}\r\n        }\r\n        this.modal.open();\r\n    },\r\n    getConfig: function() {\r\n        return this.config;\r\n    },\r\n    setConfig: function (config) {\r\n        this.config = extend(\r\n            true,\r\n            {\r\n                pick: {\r\n                    limit: 1,\r\n                    types: ['file'],\r\n                    extensions: []\r\n                }\r\n            },\r\n            config\r\n        );\r\n        if (this.modal) {\r\n            picker.modal.messaging.call('app.setConfig', this.config);\r\n        }\r\n    },\r\n    pick: function(picked) {\r\n        if (this.element) {\r\n            var tagName = this.element.tagName.toLowerCase();\r\n            if (tagName === 'input' && this.element.getAttribute('type') === 'button' || tagName === 'button') {\r\n                this.element.setAttribute('value', picked ? JSON.stringify(picked) : '');\r\n            }\r\n        }\r\n        this._trigger('pick', picked);\r\n        if (this.modal) {\r\n            this.modal.close();\r\n        }\r\n    }\r\n});\r\n\n},{\"../shared/util/createClass\":9,\"../shared/util/uid\":11,\"./components/modal\":5,\"./components/ui\":6,\"extend\":1}],8:[function(require,module,exports){\nmodule.exports = {\r\n    addClass: function (element, className) {\r\n        if (element.className) {\r\n            if (element.className.split(' ').indexOf(className) === -1) {\r\n                element.className += ' ' + className;\r\n            }\r\n        } else {\r\n            element.className = className;\r\n        }\r\n    },\r\n    removeClass: function (element, className) {\r\n        if (element.className) {\r\n            var classNames = element.className.split(' '), newClassNames = [];\r\n            for (var i = 0, l = classNames.length; i < l; i++) {\r\n                if (classNames[i] !== className) {\r\n                    newClassNames.push(classNames[i]);\r\n                }\r\n            }\r\n            element.className = newClassNames.join(' ');\r\n        }\r\n    },\r\n    loadCss: function (file) {\r\n        var link = document.createElement(\"link\");\r\n        link.href = file;\r\n        link.type = \"text/css\";\r\n        link.rel = \"stylesheet\";\r\n        link.media = \"screen,print\";\r\n\r\n        document.getElementsByTagName(\"head\")[0].appendChild(link);\r\n    }\r\n};\n},{}],9:[function(require,module,exports){\nmodule.exports = function(protoProps) {\r\n    var result = function () {\r\n        if (this.construct) {\r\n            this.construct.apply(this, arguments);\r\n        }\r\n    };\r\n\r\n    result.prototype = result;\r\n    Object.keys(protoProps).forEach(function(key) {\r\n        result.prototype[key] = protoProps[key];\r\n    });\r\n\r\n    return result;\r\n};\r\n\n},{}],10:[function(require,module,exports){\nvar uid = require('./uid');\r\n\r\nmodule.exports = require('./createClass')({\r\n    construct: function(origin, windowObject) {\r\n        var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n        var eventer = window[eventMethod];\r\n        var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n        eventer(messageEvent, function(e) {\r\n            var origin = e.origin || e.originalEvent.origin;\r\n            if (e.source === this.window && origin === this.origin || this.origin === '*') {\r\n                this.handle(e.data);\r\n            }\r\n        }.bind(this), false);\r\n\r\n        this.origin = origin;\r\n        this.window = windowObject;\r\n        this.servers = {};\r\n        this._handlers = {};\r\n    },\r\n    registerServer: function (name, object) {\r\n        this.servers[name] = object;\r\n    },\r\n    _createHandler: function() {\r\n        var handler = { callbacks: [] };\r\n        handler.then = function (callback) {\r\n            if (handler.hasOwnProperty('_result')) {\r\n                callback(handler._result);\r\n            } else {\r\n                handler.callbacks.push(callback);\r\n            }\r\n            return handler;\r\n        };\r\n        return handler;\r\n    },\r\n    call: function(method) {\r\n        var arguments = Array.prototype.slice.call(arguments, 1);\r\n        var id = uid(), handler = this._createHandler();\r\n        this._handlers[id] = handler;\r\n        this.window.postMessage({id: id, method: method, arguments: arguments}, this.origin);\r\n        return handler;\r\n    },\r\n    handle: function(message) {\r\n        if (message.method === 'resolve') {\r\n            if (this._handlers[message.id]) {\r\n                var handler = this._handlers[message.id];\r\n                for (var i = 0, l = handler.callbacks.length; i < l; i++) {\r\n                    handler.callbacks[i](message.result);\r\n                }\r\n                handler._result = message.result;\r\n                delete this._handlers[message.id];\r\n            }\r\n        } else {\r\n            var methodPath = message.method.split('.');\r\n            var method = methodPath.pop();\r\n            var target = this.servers;\r\n            while (target && methodPath.length) {\r\n                target = target[methodPath.shift()];\r\n            }\r\n            if (!target || !target[method]) {\r\n                throw 'Unknown method \"' + message.method + '\"';\r\n            }\r\n            var result = target[method].apply(target, message.arguments);\r\n            var resolve = function(res) {\r\n                // It might occure, that the id is reset, when the target frame is removed\r\n                if (message.id) {\r\n                    this.window.postMessage({method: 'resolve', id: message.id, result: res}, this.origin);\r\n                }\r\n            }.bind(this);\r\n            if (typeof result === 'function') {\r\n                result(resolve);\r\n            } else {\r\n                resolve(result);\r\n            }\r\n        }\r\n    }\r\n});\r\n\n},{\"./createClass\":9,\"./uid\":11}],11:[function(require,module,exports){\nmodule.exports = function uid () {\r\n    return '' + Math.random().toString(36).substr(2, 9);\r\n};\r\n\n},{}]},{},[7])(7)\n});\n\n","var containers = []; // will store container HTMLElement references\nvar styleElements = []; // will store {prepend: HTMLElement, append: HTMLElement}\n\nfunction insertCss(css, options) {\n    options = options || {};\n\n    var position = options.prepend === true ? 'prepend' : 'append';\n    var container = options.container !== undefined ? options.container : document.querySelector('head');\n    var containerId = containers.indexOf(container);\n\n    // first time we see this container, create the necessary entries\n    if (containerId === -1) {\n        containerId = containers.push(container) - 1;\n        styleElements[containerId] = {};\n    }\n\n    // try to get the correponding container + position styleElement, create it otherwise\n    var styleElement;\n\n    if (styleElements[containerId] !== undefined && styleElements[containerId][position] !== undefined) {\n        styleElement = styleElements[containerId][position];\n    } else {\n        styleElement = styleElements[containerId][position] = createStyleElement();\n\n        if (position === 'prepend') {\n            container.insertBefore(styleElement, container.childNodes[0]);\n        } else {\n            container.appendChild(styleElement);\n        }\n    }\n\n    // strip potential UTF-8 BOM if css was read from a file\n    if (css.charCodeAt(0) === 0xFEFF) { css = css.substr(1, css.length); }\n\n    // actually add the stylesheet\n    if (styleElement.styleSheet) {\n        styleElement.styleSheet.cssText += css\n    } else {\n        styleElement.textContent += css;\n    }\n\n    return styleElement;\n};\n\nfunction createStyleElement() {\n    var styleElement = document.createElement('style');\n    styleElement.setAttribute('type', 'text/css');\n    return styleElement;\n}\n\nmodule.exports = insertCss;\nmodule.exports.insertCss = insertCss;\n","module.exports = '.assetpicker-modal {\\n    position: fixed;\\n    top: 0;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    background: rgba(0, 0, 0, 0);\\n    z-index: -1;\\n    transition: background 0.2s, z-index 0s 0.2s;\\n}\\n.assetpicker-modal.assetpicker-modal-open {\\n    z-index:3000;\\n    background: rgba(0, 0, 0, 0.8);\\n    transition: background 0.2s\\n}\\n.assetpicker-modal .assetpicker-modal-inner {\\n    position: absolute;\\n    background: #fff;\\n    width: 800px;\\n    height: 500px;\\n    max-width: calc(100% - 30px);\\n    max-height: calc(100% - 30px);\\n    left:50%;\\n    top:50%;\\n    transform: translateY(-50%) translateX(-50%);\\n    opacity: 0;\\n    transition: opacity 0.1s 0.1s;\\n    border-radius: 4px;\\n    overflow: hidden;\\n}\\n.assetpicker-modal.assetpicker-maximized .assetpicker-modal-inner {\\n    width: 100%;\\n    height: 100%;\\n}\\n.assetpicker-modal.assetpicker-modal-open .assetpicker-modal-inner {\\n    opacity: 1;\\n}\\n.assetpicker-modal .assetpicker-modal-inner iframe {\\n    position: absolute;\\n    background: transparent;\\n    top:0;\\n    left:0;\\n    width:100%;\\n    height: 100%;\\n    overflow: hidden;\\n    border: none;\\n}\\n\\n.assetpicker-loader {\\n    border: 5px solid gray;\\n    border-radius: 30px;\\n    height: 30px;\\n    left: 50%;\\n    margin: -15px 0 0 -15px;\\n    opacity: 0;\\n    position: absolute;\\n    top: 50%;\\n    width: 30px;\\n\\n    animation: assetpicker-loader-pulsate 1s ease-out;\\n    animation-iteration-count: infinite;\\n}\\n.assetpicker-ready .assetpicker-loader {\\n    display: none;\\n    animation: none;\\n}\\n\\n@keyframes assetpicker-loader-pulsate {\\n    0% {\\n        transform: scale(.1);\\n        opacity: 0.0;\\n    }\\n    50% {\\n        opacity: 1;\\n    }\\n    100% {\\n        transform: scale(1.2);\\n        opacity: 0;\\n    }\\n}';","module.exports = '<div class=\"assetpicker-modal\">\\n    <div class=\"assetpicker-modal-inner\">\\n        <div class=\"assetpicker-loader\"></div>\\n        <iframe src=\"about:blank\" allowtransparency=\"true\">\\n            Ehm, without iframes i ain\\'t do nothing.\\n        </iframe>\\n    </div>\\n</div>\\n';","var extend = require('extend'),\r\n    util = require('../../util'),\r\n    insertCss = require('insert-css'),\r\n    transitionEvent = (function() {\r\n        var el = document.createElement('div');\r\n        var transitions = {\r\n            'transition': 'transitionend',\r\n            'OTransition': 'otransitionend',\r\n            'MozTransition': 'transitionend',\r\n            'WebkitTransition': 'webkitTransitionEnd'\r\n        };\r\n        for (var i in transitions) {\r\n            if (transitions.hasOwnProperty(i) && el.style[i] !== undefined) {\r\n                return transitions[i];\r\n            }\r\n        }\r\n    })(),\r\n    hasTransitions = function(element) {\r\n        var css = window.getComputedStyle(element, null);\r\n        var transitionDuration = ['transitionDuration', 'oTransitionDuration', 'MozTransitionDuration', 'webkitTransitionDuration'];\r\n        var hasTransition = transitionDuration.filter(function (i) {\r\n            if (typeof css[i] === 'string' && css[i].match(/[1-9]/)) {\r\n                return true;\r\n            }\r\n        });\r\n        return hasTransition.length ? true : false;\r\n    },\r\n    Messaging = require('../../../shared/util/messaging');\r\n\r\nmodule.exports = require('../../../shared/util/createClass')({\r\n    construct: function (options) {\r\n        this.options = extend(\r\n            {\r\n                template: require('./index.html'),\r\n                css: require('./index.css'),\r\n                openClassName: 'assetpicker-modal-open',\r\n                src: null\r\n            },\r\n            options\r\n        );\r\n        this.modal = null;\r\n        this.frame = null;\r\n\r\n        var matches = this.options.src.match(/^https?:\\/\\/[^\\/]+/);\r\n        this.messaging = new Messaging(matches ? matches[0] : document.location.origin)\r\n    },\r\n    render: function() {\r\n        if (this.options.css) {\r\n            insertCss(this.options.css);\r\n        }\r\n        var div = document.createElement('div');\r\n        div.innerHTML = this.options.template;\r\n        this.modal = div.children[0];\r\n        this.modal.addEventListener('click', function(event) {\r\n            if (event.target === this.modal) {\r\n                this.close();\r\n            }\r\n        }.bind(this));\r\n        this.frame = this.modal.querySelector('iframe');\r\n        document.body.appendChild(this.modal);\r\n        this._modalClass = this.modal.className;\r\n    },\r\n    open: function() {\r\n        if (!this.modal) {\r\n            this.render();\r\n            var that = this;\r\n            this.frame.src = this.options.src;\r\n            window.setTimeout(function() { that.open(); }, 1);\r\n            return;\r\n        }\r\n        this.messaging.window = this.frame.contentWindow;\r\n        util.addClass(this.modal, this.options.openClassName);\r\n    },\r\n    maximize: function () {\r\n        util.addClass(this.modal, 'assetpicker-maximized');\r\n    },\r\n    minimize: function () {\r\n        util.removeClass(this.modal, 'assetpicker-maximized');\r\n    },\r\n    _closed: function() {\r\n    },\r\n    close: function() {\r\n        if (transitionEvent && hasTransitions(this.modal)) {\r\n            var closeTransitionHandler = function () {\r\n                this.modal.removeEventListener(transitionEvent, closeTransitionHandler);\r\n                this._closed();\r\n            }.bind(this);\r\n            this.modal.addEventListener(transitionEvent, closeTransitionHandler);\r\n        } else {\r\n            this._closed();\r\n        }\r\n        util.removeClass(this.modal, this.options.openClassName);\r\n    }\r\n});\r\n","var cssLoaded = false;\r\nvar extend = require('extend');\r\nvar util = require('../../util');\r\n\r\nmodule.exports = require('../../../shared/util/createClass')({\r\n    construct: function (element, picker) {\r\n        if (!cssLoaded) {\r\n            util.loadCss(picker.getDistUrl() + '/css/picker-ui.css');\r\n        }\r\n\r\n        this.config = extend(\r\n            {\r\n                unique: true,\r\n                readonly: false\r\n            },\r\n            picker.options.ui,\r\n            {\r\n                readonly: element.hasAttribute('data-ro') ? ['false', '0'].indexOf(element.getAttribute('data-ro')) === -1 : undefined,\r\n                unique: element.hasAttribute('data-unique') ? ['false', '0'].indexOf(element.getAttribute('data-unique')) === -1 : undefined\r\n            }\r\n        );\r\n\r\n        this.add = false;\r\n        this.propagate = false;\r\n        this.picker = picker;\r\n        this.element = element;\r\n        var value = element.hasAttribute('value') ? element.getAttribute('value') : undefined;\r\n        if (value) {\r\n            try {\r\n                this.picked = JSON.parse(value);\r\n            } catch (e) {\r\n                this.picked = [];\r\n                console.error('Error while parsing value of %s', element);\r\n            }\r\n        } else {\r\n            this.picked =[];\r\n        }\r\n        if (this.picked.constructor !== Array) {\r\n            this.picked = [this.picked];\r\n        }\r\n        this.render();\r\n\r\n        var that = this;\r\n        picker.on('pick', function (picked) {\r\n            if (!that.propagate && this.element === element) {\r\n                var pickedArr = picked.constructor !== Array ? [picked] : picked;\r\n                if (that.add) {\r\n                    for (var i = 0; i < pickedArr.length; i++) {\r\n                        var contains = false;\r\n                        if (that.config.unique) {\r\n                            for (var j = 0; j < that.picked.length; j++) {\r\n                                if (that.picked[j].storage === pickedArr[i].storage && that.picked[j].id === pickedArr[i].id) {\r\n                                    contains = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (!contains) {\r\n                            that.picked.push(pickedArr[i]);\r\n                        }\r\n                    }\r\n                    pickedArr = that.picked;\r\n                }\r\n                that.pick(pickedArr);\r\n                return false;\r\n            }\r\n            that.propagate = false;\r\n            that.add = false;\r\n        });\r\n    },\r\n    pick: function (picked) {\r\n        this.picked = picked;\r\n        this.propagate = true;\r\n        this.picker.element = this.element;\r\n        this.picker.pick(this.picker._getPickConfig(this.element).limit === 1 ? (picked.length ? picked[0] : undefined) : picked);\r\n        this.render();\r\n    },\r\n    createElement: function (name, className) {\r\n        var element = document.createElement(name);\r\n        element.className = 'assetpicker-' + className.split(' ').join(' assetpicker-');\r\n        return element;\r\n    },\r\n    render: function () {\r\n        if (!this.container) {\r\n            this.container = this.element.parentNode.insertBefore(this.createElement('div', 'ui'), this.element);\r\n            this.element.parentNode.removeChild(this.element);\r\n        }\r\n        this.container.innerHTML = '';\r\n        this.renderItems(this.picked);\r\n        util[(this.picked.length || this.config.readonly ? 'add' : 'remove') + 'Class'](this.element, 'assetpicker-hidden');\r\n        this.container.appendChild(this.element);\r\n\r\n        if (this.picked.length && !this.config.readonly) {\r\n            var limit = this.picker._getPickConfig(this.element).limit;\r\n            if (limit === 0 || limit !== 1 && this.picked.length < limit) {\r\n                this.container.appendChild(this.createElement('span', 'add')).addEventListener('click', function (e) {\r\n                    this.add = true;\r\n                    this.element.setAttribute('data-limit', limit - this.picked.length);\r\n                    this.picker.open(this.element);\r\n                    this.element.setAttribute('data-limit', limit);\r\n                }.bind(this));\r\n            }\r\n        }\r\n    },\r\n    renderItems: function (picked) {\r\n        for (var i = 0, l = picked.length; i < l; i++) {\r\n            var item = this.container.appendChild(this.createElement('div', 'item'));\r\n            var preview = item.appendChild(this.createElement('div', 'preview'));\r\n            var mediaType = extend({name: 'file'}, picked[i].mediaType);\r\n            var fileTypeClass = 'ft ft-' + mediaType.name;\r\n            preview.appendChild(this.createElement('div', fileTypeClass));\r\n            if (mediaType.iconBig) {\r\n                preview.appendChild(this.createElement('div', 'icn')).style.backgroundImage = 'url(' + mediaType.iconBig + ')';\r\n            }\r\n            if (picked[i].thumbnail) {\r\n                preview.appendChild(this.createElement('div', 'tn ' + mediaType.name)).style.backgroundImage = 'url(' + picked[i].thumbnail + ')';\r\n            }\r\n            if (!this.config.readonly) {\r\n                preview.appendChild(this.createDeleteButton(picked[i]));\r\n            }\r\n            var title = item.appendChild(this.createElement('div', 'title'));\r\n            if (mediaType.icon) {\r\n                title.appendChild(this.createElement('img', 'icn')).src = mediaType.icon;\r\n            } else {\r\n                title.appendChild(this.createElement('span', fileTypeClass));\r\n            }\r\n            title.appendChild(document.createTextNode(picked[i].name));\r\n        }\r\n    },\r\n    createDeleteButton: function (item) {\r\n        var button = this.createElement('span', 'del');\r\n        button.addEventListener('click', function () {\r\n            var picked = [];\r\n            for (var i = 0, l = this.picked.length; i < l; i++) {\r\n                if (this.picked[i] !== item) {\r\n                    picked.push(this.picked[i]);\r\n                }\r\n            }\r\n            this.pick(picked);\r\n        }.bind(this));\r\n        return button;\r\n    }\r\n});","var Modal = require('./components/modal');\r\nvar UI = require('./components/ui');\r\nvar uid = require('../shared/util/uid');\r\nvar extend = require('extend');\r\n\r\nvar distUrl = (function() {\r\n    var scripts = document.getElementsByTagName('script');\r\n    return scripts[scripts.length - 1].src.split('/').slice(0, -2).join('/');\r\n})();\r\n\r\nmodule.exports = require('../shared/util/createClass')({\r\n    construct: function(config, options) {\r\n        this.setConfig(config);\r\n        options = extend(\r\n            true,\r\n            {\r\n                distUrl: distUrl,\r\n                selector: '[rel=\"assetpicker\"]',\r\n                modal: {\r\n                    src: null\r\n                },\r\n                ui: {\r\n                    enabled: true\r\n                }\r\n            },\r\n            options || {}\r\n        );\r\n        if (!options.modal.src) {\r\n            options.modal.src = options.distUrl + '/index.html';\r\n        }\r\n        if (options.modal.src.match(/^https?:\\/\\/localhost/) || document.location.hostname === 'localhost') {\r\n            options.modal.src += '?' + uid();\r\n        }\r\n\r\n        this.pickConfig = {};\r\n        this.options = options;\r\n        this.modal = null;\r\n        this.element = null;\r\n        this.uis = [];\r\n\r\n        this._memoryEvents = {\r\n            'ready': null\r\n        };\r\n        this._callbacks = {};\r\n\r\n        this.on('ready', function () {\r\n            this.modal.modal.className += ' assetpicker-ready'\r\n        });\r\n        this.on('resize', function (maximize) {\r\n            this.modal[maximize ? 'maximize' : 'minimize']();\r\n        });\r\n\r\n        document.addEventListener('DOMContentLoaded', function () {\r\n            var inputs = document.querySelectorAll(this.options.selector);\r\n            for (var i = 0, l = inputs.length; i < l; i++) {\r\n                this.register(inputs[i]);\r\n            }\r\n        }.bind(this));\r\n    },\r\n    getOrigin: function () {\r\n        return document.location.origin;\r\n    },\r\n    getDistUrl: function () {\r\n        return this.options.distUrl;\r\n    },\r\n    on: function (event, callback) {\r\n        if (!this._callbacks.hasOwnProperty(event)) {\r\n            this._callbacks[event] = [];\r\n        }\r\n        this._callbacks[event].push(callback);\r\n        if (this._memoryEvents[event]) {\r\n            callback.apply(this, this._memoryEvents[event]);\r\n        }\r\n        return this;\r\n    },\r\n    _trigger: function (event) {\r\n        var args = Array.prototype.slice.call(arguments, 1);\r\n        if (this._callbacks[event]) {\r\n            this._callbacks[event].forEach(function (callback) {\r\n                return callback.apply(this, args);\r\n            }.bind(this));\r\n        }\r\n        if (this._memoryEvents.hasOwnProperty(event)) {\r\n            this._memoryEvents[event] = args;\r\n        }\r\n    },\r\n    register: function (element) {\r\n        if (element.hasAttribute('data-assetpicker')) {\r\n            return;\r\n        }\r\n        element.setAttribute('data-assetpicker', 1);\r\n        if (element.hasAttribute('data-ui') || this.options.ui && this.options.ui.enabled) {\r\n            this.uis.push(new UI(element, this));\r\n        }\r\n        element.addEventListener('click', function (event) {\r\n            event.preventDefault();\r\n            this.open(element);\r\n        }.bind(this));\r\n    },\r\n    _getPickConfig: function (element) {\r\n        var getSplitAttr = function (attr) {\r\n            var value = element.getAttribute(attr);\r\n            return value.length ? value.split(',') : []\r\n        };\r\n        return extend({}, this.config.pick, {\r\n            limit: element.hasAttribute('data-limit') ? parseInt(element.getAttribute('data-limit')) : undefined,\r\n            types: element.hasAttribute('data-types') ? getSplitAttr('data-types') : undefined,\r\n            extensions: element.hasAttribute('data-ext') ? getSplitAttr('data-ext') : undefined\r\n        });\r\n    },\r\n    getUi: function (element) {\r\n        for (var i = 0, l = this.uis.length; i < l; i++) {\r\n            if (this.uis[i].element === element) {\r\n                return this.uis[i];\r\n            }\r\n        }\r\n    },\r\n    open: function (options) {\r\n        if (// http://stackoverflow.com/a/384380, options is a HTMLElement\r\n            typeof HTMLElement === \"object\" && options instanceof HTMLElement //DOM2\r\n            || options && typeof options === \"object\" && options !== null && options.nodeType === 1 && typeof options.nodeName===\"string\") {\r\n\r\n            this.element = options;\r\n            this.pickConfig = this._getPickConfig(options);\r\n        } else {\r\n            this.element = undefined;\r\n            this.pickConfig = extend({}, this.config.pick, options);\r\n        }\r\n        if (!this.modal) {\r\n            this.modal = new Modal(this.options.modal);\r\n            this.modal.messaging.registerServer('picker', this);\r\n            this.on(\r\n                'ready',\r\n                function () {\r\n                    this.modal.messaging.call('app.setConfig', {pick: this.pickConfig})\r\n                }\r\n            );\r\n        } else {\r\n            try {\r\n                // When this fails, it likely means the app is not ready yet and above ready listener will handle this\r\n                this.modal.messaging.call('app.setConfig', {pick: this.pickConfig});\r\n            } catch (e) {}\r\n        }\r\n        this.modal.open();\r\n    },\r\n    getConfig: function() {\r\n        return this.config;\r\n    },\r\n    setConfig: function (config) {\r\n        this.config = extend(\r\n            true,\r\n            {\r\n                pick: {\r\n                    limit: 1,\r\n                    types: ['file'],\r\n                    extensions: []\r\n                }\r\n            },\r\n            config\r\n        );\r\n        if (this.modal) {\r\n            picker.modal.messaging.call('app.setConfig', this.config);\r\n        }\r\n    },\r\n    pick: function(picked) {\r\n        if (this.element) {\r\n            var tagName = this.element.tagName.toLowerCase();\r\n            if (tagName === 'input' && this.element.getAttribute('type') === 'button' || tagName === 'button') {\r\n                this.element.setAttribute('value', picked ? JSON.stringify(picked) : '');\r\n            }\r\n        }\r\n        this._trigger('pick', picked);\r\n        if (this.modal) {\r\n            this.modal.close();\r\n        }\r\n    }\r\n});\r\n","module.exports = {\r\n    addClass: function (element, className) {\r\n        if (element.className) {\r\n            if (element.className.split(' ').indexOf(className) === -1) {\r\n                element.className += ' ' + className;\r\n            }\r\n        } else {\r\n            element.className = className;\r\n        }\r\n    },\r\n    removeClass: function (element, className) {\r\n        if (element.className) {\r\n            var classNames = element.className.split(' '), newClassNames = [];\r\n            for (var i = 0, l = classNames.length; i < l; i++) {\r\n                if (classNames[i] !== className) {\r\n                    newClassNames.push(classNames[i]);\r\n                }\r\n            }\r\n            element.className = newClassNames.join(' ');\r\n        }\r\n    },\r\n    loadCss: function (file) {\r\n        var link = document.createElement(\"link\");\r\n        link.href = file;\r\n        link.type = \"text/css\";\r\n        link.rel = \"stylesheet\";\r\n        link.media = \"screen,print\";\r\n\r\n        document.getElementsByTagName(\"head\")[0].appendChild(link);\r\n    }\r\n};","module.exports = function(protoProps) {\r\n    var result = function () {\r\n        if (this.construct) {\r\n            this.construct.apply(this, arguments);\r\n        }\r\n    };\r\n\r\n    result.prototype = result;\r\n    Object.keys(protoProps).forEach(function(key) {\r\n        result.prototype[key] = protoProps[key];\r\n    });\r\n\r\n    return result;\r\n};\r\n","var uid = require('./uid');\r\n\r\nmodule.exports = require('./createClass')({\r\n    construct: function(origin, windowObject) {\r\n        var eventMethod = window.addEventListener ? \"addEventListener\" : \"attachEvent\";\r\n        var eventer = window[eventMethod];\r\n        var messageEvent = eventMethod == \"attachEvent\" ? \"onmessage\" : \"message\";\r\n        eventer(messageEvent, function(e) {\r\n            var origin = e.origin || e.originalEvent.origin;\r\n            if (e.source === this.window && origin === this.origin || this.origin === '*') {\r\n                this.handle(e.data);\r\n            }\r\n        }.bind(this), false);\r\n\r\n        this.origin = origin;\r\n        this.window = windowObject;\r\n        this.servers = {};\r\n        this._handlers = {};\r\n    },\r\n    registerServer: function (name, object) {\r\n        this.servers[name] = object;\r\n    },\r\n    _createHandler: function() {\r\n        var handler = { callbacks: [] };\r\n        handler.then = function (callback) {\r\n            if (handler.hasOwnProperty('_result')) {\r\n                callback(handler._result);\r\n            } else {\r\n                handler.callbacks.push(callback);\r\n            }\r\n            return handler;\r\n        };\r\n        return handler;\r\n    },\r\n    call: function(method) {\r\n        var arguments = Array.prototype.slice.call(arguments, 1);\r\n        var id = uid(), handler = this._createHandler();\r\n        this._handlers[id] = handler;\r\n        this.window.postMessage({id: id, method: method, arguments: arguments}, this.origin);\r\n        return handler;\r\n    },\r\n    handle: function(message) {\r\n        if (message.method === 'resolve') {\r\n            if (this._handlers[message.id]) {\r\n                var handler = this._handlers[message.id];\r\n                for (var i = 0, l = handler.callbacks.length; i < l; i++) {\r\n                    handler.callbacks[i](message.result);\r\n                }\r\n                handler._result = message.result;\r\n                delete this._handlers[message.id];\r\n            }\r\n        } else {\r\n            var methodPath = message.method.split('.');\r\n            var method = methodPath.pop();\r\n            var target = this.servers;\r\n            while (target && methodPath.length) {\r\n                target = target[methodPath.shift()];\r\n            }\r\n            if (!target || !target[method]) {\r\n                throw 'Unknown method \"' + message.method + '\"';\r\n            }\r\n            var result = target[method].apply(target, message.arguments);\r\n            var resolve = function(res) {\r\n                // It might occure, that the id is reset, when the target frame is removed\r\n                if (message.id) {\r\n                    this.window.postMessage({method: 'resolve', id: message.id, result: res}, this.origin);\r\n                }\r\n            }.bind(this);\r\n            if (typeof result === 'function') {\r\n                result(resolve);\r\n            } else {\r\n                resolve(result);\r\n            }\r\n        }\r\n    }\r\n});\r\n","module.exports = function uid () {\r\n    return '' + Math.random().toString(36).substr(2, 9);\r\n};\r\n"]}